# TensorFood

#transferlearning #mobilenet

Labels:
ayammasakmerah
burger
chendol
chicken chop
fish and chips
fries
ice cream
icekacang
meerebus
meesiam
nasiayam
nasilemak
pancakes
pizza
rotiprata
salad
satay
waffles
wantonnoodle

<!-- This demo imports a TensorFlow model that is generated by tf.while_loop
for inference in the browser. The model was pre-converted to TensorFlow.js
format and hosted on Google Cloud, using the steps in
the repo's [README.md](../../README.md).

The following commands will start a web server on `localhost:1234` and open
a browser page with the demo.

The demo allows you to change the conditions of the loop interactively and observe the execution result right in the browser.

```bash
cd demo # If not already in the demo directory.
yarn # Installs dependencies.
yarn control_flow # Starts a web server and opens a page. Also watches for changes.
``` -->

## 0. Environments

1. TensorFlow: `tensorflow==1.8.*`
2. TensorFlow Lite: `tensorflow==1.7.*`
3. TensorFlow Mobile iOS:`tensorflow==1.1.*`

## 1. Train Model

Edit the config file accordingly. (Do note that to deploy your model in iOS, your architecture must not be too heavy.) Then:

```bash
source config
make tensorboard_kill
make train
```

This gives us `retrained_graph.pb` and `retrained_labels.txt` files. Note that the last line is specifically for deploying TF Mobile on iOS. To do this, create a conda environment with TensorFlow v1.1 installed, and call it `tensorflowmobileios`. Then:

```bash
source activate tensorflowmobileios
make train_tfmobileios
source deactivate
```

## 2. Serialising the Graph

Serialise the `GraphDef` ProtoBuf file to give `optimized_graph.pb`. Last line is optional - quantising the ProtoBuf file to give `rounded_graph.pb`.

```bash
make optimise_pb
make quantize_android_pb
```

Alternatively, we can serialise the `GraphDef` to FlatBuffers, giving us `optimized_graph.lite`.

```bash
source activate tensorflowlite
make optimize_fb
source deactivate
```

## 3. Deployment

### Desktop

```bash
make test
```

### Android: TensorFlow Mobile

```bash
make optimise_pb
make export_tfmobile_to_android
```

### Android: TensorFlow Lite

```bash
make export_tflite_to_android
AndroidStudio android/tflite
```

### iOS: TensorFlow Mobile

```bash
make train_tfmobileios
make export_tfmobile_to_ios
```

### iOS: TensorFlow Lite

```bash
make export_tflite_to_ios
pod update
open ios/tflite/*.xcworkspace
```

### Web

1) Distributed TensorFlow
2) Hadoop
3) S3
4) TensorFlow.js
5) TensorFlow Serving
